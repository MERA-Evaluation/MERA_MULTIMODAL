# ruTiE-Image


## Описание задачи

ruTiE-Image — мультимодальная эмуляция теста Тьюринга, и сформирована как неизменяемая последовательность вопросно-ответных заданий с опцией выбора ответа. Это 3 связных диалога, каждый с имитацией 500 обращений пользователя к модели посредством текста и картинок. Варианты ответа (4 к каждому заданию) модель получает текстом и выбирает из них.

Задания теста проверяют способность модели адекватно поддерживать диалог на естественно меняющиеся темы общения, опираясь на контекст предыдущих вопросов.

Датасет основан на одноименном текстовом датасете из первого релиза бенчмарка MERA. Кроме ruTiE-Image, датасет представлен ещё в 2 вариантах: текстовом и звуковом (вопросы подаются в аудио, модель отвечает текстом).

Тестируемые навыки моделей: Object recognition, Object recognition, Human-human interaction, Human-object interaction, Object recognition, Common everyday knowledge, Common domain knowledge, Topic understanding, Scene understanding, Analogical reasoning, Static counting, Mathematical reasoning

Авторы: Денис Шевелев, Артем Червяков, Алена Феногенова, Сергей Марков (автор идеи)


## Мотивация

Датасет предназначен для анализа моделей с достаточной длиной контекстного окна (в идеале вмещающего контекст глубиной до 499 предыдущих вопросов), но применим и для моделей с меньшим контекстным окном от 15 вопросов глубиной. 

Заложенная в тест задача сложна не только необходимостью сохранять контекст разговора и обращаться к нему в ходе диалога, но и необходимостью обладать широкими знаниями в области языковой картины мира: поговорок, считалок, крылатых речевых оборотов, фраз из известных фильмов, песен, спектаклей, книг, мемов, — а также характерными для человеческой беседы спонтанно актуализируемыми навыками: устный счёт, распознавание иронии, умение понять и достроить шутку, пространственное мышление, билингвизм, распознавание и использование причинно-следственных связей, избегание речевых ловушек. Только комплексное использование всех этих навыков позволяет полноценно “играть в имитацию” по Тьюрингу — адекватно участвовать в человеческой беседе на равных с людьми.

Поскольку в беседе меняются модальности общения (собеседник может показать вам картинку, попросить прочитать нарисованную на стене надпись, апеллировать к ранее показанной фотографии, пригласить к беседе третьего человека, высказать какое-то мнение или суждение — и так далее), то дизайн отдельного задания в диалоге не всегда форматирован в качестве вопроса — оно может быть оформлено как реплика-сентенция, на которую модели нужно выбрать адекватную реакцию, в ruTiE-Image задание может выглядеть как просто присланная модели картинка без сопроводительного вопроса — но с предложенными вариантами реакций, из которых следует выбрать нужную. ruTiE-Image предлагает на выбор 4 варианта ответа на каждый вопрос.

Тест поверяет способность модели
- удерживать контекст, 
- поддерживать (на общедоступном разговорном уровне) диалог на любой из основных тематических доменов (см. домены бенчмарка MERA)
- различать базовые классы задач, без которых не решить задания эмуляции теста Тьюринга (включая простейшую математику, этику, лингвистические игры, общий кругозор и так далее)
- ориентироваться в различных категориях мышления, включая распознавание иронии, эмоций и намерения собеседника, восстановление логической последовательности ситуации по элементам и так далее.

Для валидности проверки способностей модели с помощью ruTiE есть важное ограничение. Поскольку около половины вопросов так или иначе завязаны на ближний контекст эмулируемой “беседы”, последующий вопрос может подсказать ответ на предыдущий. В связи с этим недопустима подача вопросов ruTiE модели по несколько штук разом. Вопросы подаются строго по одному, их порядок и последовательность не должны перетасовываться или меняться иным образом.


## Описание датасета

### Поля данных

Каждый вопрос в датасете содержит следующие поля:

- `instruction` [str] — Промпт-инструкция для модели, содержащая шаблон для вставки элементов вопроса.
- `inputs` — Вводные данные, формирующие задание для модели.
    - `image` [str] — Путь к файлу с изображением, к которому относится вопрос.
    - `question` [str] — Текст вопроса.
    - `option_a` [str] — Вариант ответа A.
    - `option_b` [str] — Вариант ответа B.
    - `option_c` [str] — Вариант ответа C.
    - `option_d` [str] — Вариант ответа D.
- `outputs` [str] — Правильный ответ на вопрос.
- `meta` — Метаданные, относящиеся к тестовому примеру, но не используемые в вопросе (скрытые от тестируемой модели).
    - `id` [int] — Номер-идентификатор вопроса в датасете.
    - `type` [str] — Тематический домен в датасете.
    - `unified_category` [str] — Унифицированная категория по типам мышления.
    - `nonunified_category` [str] — Неунифицированная категория по типам мышления аудио/визуальной модальности.
    - `turing_imitation` [str] — Категория эмуляции теста Тьюринга, проверяемая вопросом.
    - `short_context` [int] — Индикатор необходимости последних 1-2 вопросов для ответа.
    - `long_context` [int] — Индикатор необходимости последних более чем 1-2 вопросов для ответа.
    - `image` — Метаданные, относящиеся к изображению.
        - `type` [str] — Тип изображения — согласно классификации изображений для датасетов MERA.


### Пример данных

```json
{
    "instruction": "Вам придётся запоминать контекст\n<context> беседы, которую с вами ведут текстом и картинками. В каждом задании сопоставьте картинку <image>, если она есть, и текст вопроса, если он есть, с контекстом предыдущей беседы - и выберите наиболее верный вариант ответа. Выведите одну букву, которая его обозначает. Вопрос:\n{question}\nA. {option_a}\nB. {option_b}\nC. {option_c}\nD. {option_d}\nОтвет:",
    "inputs": {
        "image": "samples/image0001.png",
        "question": "Привет! Я буду звать тебя Ада, а чтобы узнать, как меня зовут, взгляни на картинку и ответь, кто покрасил их в розовый цвет, - а потом возьми три первых буквы этого слова. Так как меня звать?",
        "option_a": "Худ",
        "option_b": "Сол",
        "option_c": "Мал",
        "option_d": "Зак"
    },
    "outputs": "Б",
    "meta": {
        "id": 1,
        "type": "Вводная категория",
        "unified_category": "trap",
        "nonunified_category": "Опознание ситуации",
        "turing_imitation": "algorithmic_transformations",
        "short_context": 0,
        "long_context": 0,
        "image": {
            "type": "real"
        }
    }
}
```


### Создание датасета

Датасет собран внутренними экспертами вручную, после чего провалидирован. Изображения для датасета собирались методом краудсорсинга из не выкладывавшихся ранее в Сеть мобильных фото, что обеспечивает актуальность и современность материалов.


## Оценка

### Метрики

Для агрегированной оценки ответов моделей используются следующие метрики:

- `Exact match`: Метрика Exact match вычисляет среднее по оценкам всех обработанных вопросов, где оценка имеет значение 1, если предсказанная строка точно совпадает с правильным ответом, и 0 в остальных случаях.


### Human baseline

Human baseline — это оценка усредненных ответов людей на вопросы бенчмарка. Оценка проводится по тем же метрикам, что и для моделей.

Для всех вопросов датасета были получены ответы разметчиков на crowd-source платформе с перекрытием 5. Агрегированным ответом считался тот, который был выбран большинством (majority vote).

Результаты оценки:

- Exact match – 0.55
