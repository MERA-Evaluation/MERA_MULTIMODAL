include: ../custom_loglikelihood_task.yaml
tag:
  - mera_audio
  - mera_all
task: rutie_audio
dataset_path: MERA-evaluation/ruTiE_audio
context_based: true
request_updater: !function utils._update_request
storage_updater: !function utils._update_storage
fewshot_split: test
fewshot_config:
  sampler: !function ../custom_context_formers.ruTiEContextFormer  # processes no instruction doc and changes doc_to_text
  doc_to_text_without_instruction: "{{'<audio>\nA. {option_a}\nB. {option_b}\nC. {option_c}\nD. {option_d}\nОтвет: RUTIE_TARGET_{idx}'.format(idx=meta['question_id'], **inputs).lstrip()}}"
  doc_to_text_without_target: "{{'<audio>\nA. {option_a}\nB. {option_b}\nC. {option_c}\nD. {option_d}\nОтвет:'.format(**inputs).lstrip()}}"
process_docs: !function utils.process_docs
doc_to_text: "{{instruction.replace('{', '{{').replace('}', '}}').replace('{{option_a}}', '{option_a}').replace('{{option_b}}', '{option_b}').replace('{{option_c}}', '{option_c}').replace('{{option_d}}', '{option_d}').format(**inputs).strip()}}"
doc_to_target: "{{'RUTIE_TARGET_{idx}'.format(idx=meta['question_id'])}}"
doc_to_audio: !function utils.doc_to_audio
num_fewshot: 1
metadata:
  version: 1.0
